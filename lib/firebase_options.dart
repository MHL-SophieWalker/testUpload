// File generated by FlutterFire CLI.
// ignore_for_file: lines_longer_than_80_chars, avoid_classes_with_only_static_members
import 'package:firebase_core/firebase_core.dart' show FirebaseOptions;
import 'package:flutter/foundation.dart' show defaultTargetPlatform, kIsWeb, TargetPlatform;

/// Default [FirebaseOptions] for use with your Firebase apps.
///
/// Example:
/// ```dart
/// import 'firebase_options.dart';
/// // ...
/// await Firebase.initializeApp(
///   options: DefaultFirebaseOptions.currentPlatform,
/// );
/// ```
class DefaultFirebaseOptions {
  static FirebaseOptions get currentPlatform {
    if (kIsWeb) {
      return web;
    }
    switch (defaultTargetPlatform) {
      case TargetPlatform.android:
        return android;
      case TargetPlatform.iOS:
        return ios;
      case TargetPlatform.macOS:
        return macos;
      case TargetPlatform.windows:
        throw UnsupportedError(
          'DefaultFirebaseOptions have not been configured for windows - '
          'you can reconfigure this by running the FlutterFire CLI again.',
        );
      case TargetPlatform.linux:
        throw UnsupportedError(
          'DefaultFirebaseOptions have not been configured for linux - '
          'you can reconfigure this by running the FlutterFire CLI again.',
        );
      default:
        throw UnsupportedError(
          'DefaultFirebaseOptions are not supported for this platform.',
        );
    }
  }

  static const FirebaseOptions web = FirebaseOptions(
    apiKey: 'AIzaSyCCdP16VbUZA77k7CvC97YGZaWtFgJnTWw',
    appId: '1:624926509956:web:649a45e9b90bb15b72ebd1',
    messagingSenderId: '624926509956',
    projectId: 'hartsuite-655a5',
    authDomain: 'app.hartsuite.com',
    storageBucket: 'hartsuite-655a5.appspot.com',
    measurementId: 'G-VPBWF9M1NV',
  );

  static const FirebaseOptions android = FirebaseOptions(
    apiKey: 'AIzaSyDpszNTOuHRH00sI9fly2a0Idh45Cn7di0',
    appId: '1:624926509956:android:29fabb29a325e16972ebd1',
    messagingSenderId: '624926509956',
    projectId: 'hartsuite-655a5',
    storageBucket: 'hartsuite-655a5.appspot.com',
  );

  static const FirebaseOptions ios = FirebaseOptions(
    apiKey: 'AIzaSyAsscvQrHUmDkgON7VCpkeM1mukM7s3FPw',
    appId: '1:624926509956:ios:050757bedf066afc72ebd1',
    messagingSenderId: '624926509956',
    projectId: 'hartsuite-655a5',
    storageBucket: 'hartsuite-655a5.appspot.com',
    androidClientId: '624926509956-b39m3f8pd6k28lc43n0a9lpcrjj3p2v6.apps.googleusercontent.com',
    iosClientId: '624926509956-9ofqfnm34rk85dee8609bdr5vkqhra5g.apps.googleusercontent.com',
    iosBundleId: 'com.mhl.hartSuite',
  );

  static const FirebaseOptions macos = FirebaseOptions(
    apiKey: 'AIzaSyAsscvQrHUmDkgON7VCpkeM1mukM7s3FPw',
    appId: '1:624926509956:ios:050757bedf066afc72ebd1',
    messagingSenderId: '624926509956',
    projectId: 'hartsuite-655a5',
    storageBucket: 'hartsuite-655a5.appspot.com',
    androidClientId: '624926509956-b39m3f8pd6k28lc43n0a9lpcrjj3p2v6.apps.googleusercontent.com',
    iosClientId: '624926509956-9ofqfnm34rk85dee8609bdr5vkqhra5g.apps.googleusercontent.com',
    iosBundleId: 'com.mhl.hartSuite',
  );
}
