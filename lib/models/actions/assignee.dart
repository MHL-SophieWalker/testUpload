import 'package:cloud_firestore/cloud_firestore.dart';
import 'package:hart_suite/models/general/auditable.dart';
import 'package:hart_suite/models/profile/person_snapshot.dart';

class Assignee {
  String? documentId;
  PersonSnapshot person;
  DateTime? done;
  String? note;
  Auditable? created;
  Auditable? updated;
  Auditable? deleted;

  Assignee({this.documentId, required this.person, this.done, this.note, this.created, this.updated, this.deleted});

  static Assignee? fromMap(Map<String, dynamic>? map) {
    Assignee? assignee;

    if (map == null || map.isEmpty || map['documentId'] == null) {
      assignee = null;
    } else {
      assignee = Assignee(
          documentId: map.containsKey('documentId') ? map['documentId'] : null,
          person: map.containsKey('person') ? PersonSnapshot.fromMap(map['person'])! : throw Exception('PersonSnapshot is required'),
          done: map.containsKey('done')
              ? map['done'] == null
                  ? null
                  : (map['done'] as Timestamp).toDate()
              : null,
          note: map.containsKey('note') ? map['note'] : null,
          created: map.containsKey('created') ? Auditable.fromMap(map['created']) : null,
          updated: map.containsKey('updated') ? Auditable.fromMap(map['updated']) : null,
          deleted: map.containsKey('deleted') ? Auditable.fromMap(map['deleted']) : null);
    }

    return assignee;
  }

  Map<String, dynamic> toMap() {
    return {
      'documentId': documentId,
      'person': person.toMap(),
      'done': done,
      'note': note,
      'created': created?.toMap(),
      'updated': updated?.toMap(),
      'deleted': deleted?.toMap()
    };
  }
}
