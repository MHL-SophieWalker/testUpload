class ActionStatus {
  String? documentId;
  String name;
  String iconCode;

  ActionStatus({this.documentId, required this.name, required this.iconCode});

  static ActionStatus? fromMap(Map<String, dynamic>? map) {
    ActionStatus? actionStatus;

    if (map == null || map.isEmpty || map['documentId'] == null) {
      actionStatus = null;
    } else {
      actionStatus = ActionStatus(
        documentId: map.containsKey('documentId') ? map['documentId'] : null,
        name: map.containsKey('name') ? map['name'] : '',
        iconCode: map.containsKey('iconCode') ? map['iconCode'] : 'all_out',
      );
    }

    return actionStatus;
  }

  Map<String, dynamic> toMap() {
    return {
      'documentId': documentId,
      'name': name,
      'iconCode': iconCode,
    };
  }
}
