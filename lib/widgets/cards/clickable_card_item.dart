import 'package:flutter/material.dart';

class ClickableCardItem extends StatelessWidget {
  const ClickableCardItem({
    super.key,
    required this.title,
    this.leading,
    required this.onTap,
    required this.trailing,
  });

  final String title;
  final Widget? leading, trailing;
  final Function? onTap;

  @override
  Widget build(BuildContext context) {
    return GestureDetector(
      onTap: () => {
        onTap == null ? null : onTap!(),
      },
      child: MouseRegion(
        cursor: onTap != null ? SystemMouseCursors.click : SystemMouseCursors.basic,
        child: Card(
          color: Theme.of(context).cardColor,
          child: Padding(
            padding: const EdgeInsets.all(8.0),
            child: Row(
              children: [
                const SizedBox(height: 30), //ensure a reasonable height for all cards to allow for consistent spacing
                Align(
                  alignment: Alignment.centerLeft,
                  child: leading,
                ),
                leading != null ? const SizedBox(width: 8) : const SizedBox(width: 0),
                Flexible(
                  fit: FlexFit.tight,
                  child: Align(
                    alignment: Alignment.centerLeft,
                    child: Text(
                      title,
                      overflow: TextOverflow.ellipsis,
                      style: const TextStyle(fontSize: 16),
                    ),
                  ),
                ),
                leading != null ? const SizedBox(width: 8) : const SizedBox(width: 0),
                Align(
                  alignment: Alignment.centerRight,
                  child: trailing,
                ),
              ],
            ),
          ),
        ),
      ),
    );
  }
}
