import 'package:flutter/material.dart';
import 'package:hart_suite/helpers/ui/filter_help.dart';
import 'package:hart_suite/models/general/filter.dart';
import 'package:hart_suite/style/style_base.dart';
import 'package:hart_suite/widgets/misc/app_version_info.dart';
import 'package:hart_suite/widgets/misc/expand_clicker.dart';

class Sidebar extends StatefulWidget {
  const Sidebar({super.key, required this.expanded, required this.filters, required this.callback, this.errors = const [], this.onExpand});
  final bool expanded;
  final Function callback;
  final List<Filter> filters;
  final List<String> errors;
  final Function? onExpand;

  @override
  State<Sidebar> createState() => _SidebarState();
}

class _SidebarState extends State<Sidebar> {
  late bool expanded = widget.expanded;

  @override
  Widget build(BuildContext context) {
    return Container(
      decoration: StyleBase.getSidebarBoxShadowDecoration(),
      child: SizedBox(
        width: expanded ? 200 : 50,
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            ExpandClicker(
                onTap: () => setState(() {
                      expanded = !expanded;
                      widget.onExpand != null ? widget.onExpand!() : null;
                    }),
                expanded: expanded),
            Expanded(
              child: SizedBox(
                width: expanded ? 200 : 50,
                child: SingleChildScrollView(
                  scrollDirection: Axis.vertical,
                  child: ToggleButtons(
                    renderBorder: false,
                    isSelected: FilterHelp.getSelectedFilterBools(widget.filters),
                    onPressed: (int index) {
                      widget.callback(index);
                    },
                    direction: Axis.vertical,
                    children: FilterHelp.getFilters(
                      widget.filters,
                      expanded,
                      errors: widget.errors,
                    ),
                  ),
                ),
              ),
            ),
            AppVersionInfo(expanded: expanded),
          ],
        ),
      ),
    );
  }
}
