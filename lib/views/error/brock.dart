import 'package:flutter/material.dart';
import 'package:hart_suite/views/main/home.dart';

class BrockPage extends StatelessWidget {
  static const route = '/404';
  final BrockArgs? args;

  const BrockPage({super.key, this.args});

  @override
  Widget build(BuildContext context) {
    BrockArgs bArgs;

    if (args == null) {
      bArgs = ModalRoute.of(context)!.settings.arguments as BrockArgs? ?? BrockArgs();
    } else {
      bArgs = args!;
    }

    return Scaffold(
      appBar: AppBar(
        leading: !Navigator.canPop(context) ? IconButton(icon: const Icon(Icons.home), onPressed: () => Navigator.pushNamed(context, HomePage.route)) : null,
        title: const Text('We have a problem!'),
      ),
      body: Center(
        child: Column(
          children: [
            Padding(
              padding: const EdgeInsets.all(12),
              child: Image.asset(
                'assets/images/500.jpeg',
                height: MediaQuery.of(context).size.height * .5,
                scale: 1,
              ),
            ), //sort the size of the image and padding
            const Text('The page you tried to access has experienced a problem. Please inform your system administrator.'),
            TextButton(
              onPressed: () => Navigator.pushNamed(context, bArgs.route!, arguments: bArgs.collection),
              child: Text('Return to ${bArgs.page} page.'),
            ),
          ],
        ),
      ),
    );
  }
}

class BrockArgs {
  String? page;
  String? route;
  String? collection;

  BrockArgs({this.page, this.route, this.collection}) {
    if (page == null || route == null) {
      page = 'Home';
      route = HomePage.route;
    }
  }
}
