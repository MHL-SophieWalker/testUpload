import 'package:hart_suite/helpers/firebase/firestore_helper.dart';

class GlobalAdminRepo {
  final String basePath = 'customers';
  final String collectionName = 'apps';
  final String id = 'HartSuite';
  late String path;
  late String customer;

  GlobalAdminRepo({bool useMocks = false, required this.customer}) {
    path = '$basePath/$customer/$collectionName';
    FirestoreHelper.useMocks = useMocks;
  }

  Future<List<String>> get({bool populate = false}) async {
    List<String> admins = List.empty(growable: true);

    await FirestoreHelper.instance?.getDocumentById(path: path, id: id).then((value) {
      if (value.exists) {
        for (String s in value.get('admins')) {
          admins.add(s);
        }
      }
    });

    return admins;
  }

  Future<void> update({required List<String> admins}) async {
    await FirestoreHelper.instance?.updateDocument(path: path, data: {'admins': admins}, id: id);
  }
}
