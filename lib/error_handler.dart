// ignore_for_file: avoid_print

import 'package:firebase_crashlytics/firebase_crashlytics.dart';
import 'package:flutter/foundation.dart';

class ErrorHandler {
  static setupHandler() {
    if (kIsWeb) {
    } else {
      _useCrashlytics();
    }
  }

  static _useCrashlytics() {
    FlutterError.onError = FirebaseCrashlytics.instance.recordFlutterError;

    // Pass all uncaught asynchronous errors that aren't handled by the Flutter framework to Crashlytics
    PlatformDispatcher.instance.onError = (error, stack) {
      FirebaseCrashlytics.instance.recordError(error, stack, fatal: true);
      return true;
    };
  }

  static logError({required dynamic exception, StackTrace? stack, Iterable<Object> information = const []}) async {
    if (kIsWeb) {
      print(exception);
      print(stack);
      print(information);
    } else {
      await FirebaseCrashlytics.instance.recordError(exception, stack, information: information);
    }
  }

  static log(String message) {
    if (kIsWeb) {
      print(message);
    } else {
      FirebaseCrashlytics.instance.log(message);
    }
  }
}
